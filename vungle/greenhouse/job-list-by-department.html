<!doctype html>
<html>
	<head>
		<title>Greenhouse</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
		<style type="text/css">
		html, body {
			background-color: #000;
			color: #ccc;
			}	
		a {
			color:#2f90ce;
		}
		</style>
	</head>
	
<body>

	
	
	<script>
		
		
		
		
		
		// Grabs query string
		function getQueryVariable(variable)
		{
		       var query = window.location.search.substring(1);
		       var vars = query.split("&");
		       for (var i=0;i<vars.length;i++) {
		               var pair = vars[i].split("=");
		               if(pair[0] == variable){return pair[1];}
		       }
		       return(false);
		       
		}
		var query = getQueryVariable('id');
		console.log(query);
		
		
		
		
		
		
		
		
		
		var greenuri = 'https://api.greenhouse.io/v1/boards/vungle/embed/'
		
		var jobs = greenuri+'jobs';
		var offices = greenuri+'offices';
		var departments = greenuri+'departments'
		
		$.ajax({
		    url: departments,
		    type: "GET",
		    dataType: 'jsonp',
		    cache: true,
		    data: {content: true}, //loads job content into new object
		    context: document.body,
		    success: function (data, status, error) {
		      console.log('success', data);
		      
		      	
		      	//var jobid = 830;
		      	
		      	//console.log(query+' query')
		      //	console.log(jobid+' jobid')
		      	//console.log(typeof jobid);
		      	//console.log(typeof query);
		      	
		      	//if(query == jobid){console.log('twinsies')};
		      		      	
		      	//if (urlid === )
			  	//console.log(data.departments);
			  	var depts = data.departments;
			  	//console.log(depts[1].name); // name = bus dev
			  	//console.log(data.departments[3].id); //department id
			  	
				//console.log(depts[1].jobs[0]); // job object
				//console.log(depts[1].jobs[0].title);	//job title
				//console.log(depts[1].jobs[0].location.name); //location of job	
				
				for(i = 0; i < depts.length; i++){
					
					//console.log(depts[i].id + 'wtf');
					
					if (depts[i].id == query) {
						$('#dept').append(depts[i].name);
						//console.log(depts[i].jobs[0].title);
						
						for(j = 0; j < depts[i].jobs.length; j++){
							var title = depts[i].jobs[j].title;
							var location = depts[i].jobs[j].location.name;
							
							//console.log(title);
							//console.log(location);
							
							$('#joblisting').append(
								'<tr>'+
						          '<td><a href="'+jobapp+'" alt="">'+title+'</a></td>'+
						          '<td><a href="'+locationurl+'" alt="">'+location+'</a></td>'+
						        '</tr>'
							);
							
						};
						
						
					}//if
					
					
					
				}//for	

	
		      
		    },
		    error: function (data, status, error) {
		      console.log('error', data, status, error);
		    }
		});
		
	</script>
	
	<h1 class="text-center" id="dept"><!-- department --></h1>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-12">
		
		<table class="table table-striped">
	      <thead>
	        <tr>

	          <th>Position</th>
	          <th>Location</th>
	        </tr>
	      </thead>
	      <tbody id="joblisting">
		      <!-- job listings-->
	      </tbody>
	    </table>
		
			</div>
		</div>	
	</div>


</body>
</html>